import cv2
import numpy as np
import matplotlib.pyplot as plt
def extract_skin(image):
    hsv = cv2.cvtColor(image, cv2.COLOR_BGR2HSV)
    lower_skin = np.array([0, 20, 70], dtype=np.uint8)
    upper_skin = np.array([20, 255, 255], dtype=np.uint8)
    skin_mask = cv2.inRange(hsv, lower_skin, upper_skin)
    kernel = cv2.getStructuringElement(cv2.MORPH_ELLIPSE, (5, 5))
    skin_mask = cv2.morphologyEx(skin_mask, cv2.MORPH_CLOSE, kernel, iterations=4)
    skin = cv2.bitwise_and(image, image, mask=skin_mask)
    return skin, skin_mask
image = cv2.imread('picture/p1.jpg')
skin, skin_mask = extract_skin(image)
plt.subplot(1, 3, 1)
plt.title('Original Image')
plt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
plt.subplot(1, 3, 2)
plt.title('Skin Mask')
plt.imshow(skin_mask, cmap='gray')
plt.subplot(1, 3, 3)
plt.title('Extracted Skin')
plt.imshow(cv2.cvtColor(skin, cv2.COLOR_BGR2RGB))
plt.show()
image = cv2.imread('picture/p2.jpg')
skin, skin_mask = extract_skin(image)
plt.subplot(1, 3, 1)
plt.title('Original Image')
plt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
plt.subplot(1, 3, 2)
plt.title('Skin Mask')
plt.imshow(skin_mask, cmap='gray')
plt.subplot(1, 3, 3)
plt.title('Extracted Skin')
plt.imshow(cv2.cvtColor(skin, cv2.COLOR_BGR2RGB))
plt.show()
